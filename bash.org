#+property: header-args :tangle ~/.bashrc
#+startup: content

#+begin_src bash
# If not running interactively, don't do anything
[[ $- != *i* ]] && return
#+end_src

* Options
#+begin_src bash
shopt -s cdspell
# shopt -s checkwinsize
#+end_src

* Keymaps
#+begin_src bash :noweb yes
bind -x '"\ew": printf "\033]52;c;%s" "$(base64<<<"$READLINE_LINE")"'
bind -x '"\C-xp": printf "\033]52;c;%s" "$(base64<<<"${PWD/#$HOME/\~}")"'
# ^ like in Vim
bind -x '"\C-x^": exec zsh'
bind -x '"\C-xs": ssh <<alternate()>>'
#+end_src

** TODO Toggle shopts
https://github.com/ghostty-org/ghostty/discussions/5851
Use f13 like for neovim/emacs toggling keymaps
#+begin_src bash
# Toggle extglob (enable extended pattern matching)
# bind '"\C-xe": "\C-u shopt -q extglob && shopt -u extglob || shopt -s extglob\n"'
# bind -x '"\C-x/": "shopt -q extglob && shopt -u extglob || shopt -s extglob"'
# bind -x '"\C-x*": "shopt -q globstar && shopt -u globstar || shopt -s globstar"'
# stty wrap?
#+end_src

* Aliases
#+begin_src bash :noweb yes
<<sh|.org:aliases()>>

# maybe works for pure aliases and not subcommands/functions
# Enable tab completion for function wrappers using complete-alias
# https://github.com/cykerway/complete-alias
if [ -f /usr/share/bash-complete-alias/complete_alias ]; then
    source /usr/share/bash-complete-alias/complete_alias
    <<sh|.org:completion-functions()>>
    for entry in "${_completion_funcs[@]}"; do
        IFS=: read -r alias_name cmd_name <<< "$entry"
        complete -F _complete_alias "$alias_name"
    done
    unset _completion_funcs
fi
#+end_src

* Functions
#+begin_src bash :noweb yes
<<sh|.org:functions()>>
#+end_src

* External commands
#+begin_src bash :noweb yes
<<sh|.org:commands(shell="bash")>>
#+end_src
