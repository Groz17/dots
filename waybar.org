* Config
:PROPERTIES:
:header-args: :tangle ~/.config/waybar/config.jsonc
:END:

disk percentage?
notifiche ricevute?

** Bar
 #+begin_src jsonc :prologue "{"
// show if muted
"layer": "top",
"position": "top",
"spacing": 0,
"height": 0,
"margin-top": 0,
"margin-right": 0,
"margin-bottom": 0,
"margin-left": 0,
#+end_src

** Modules
*** Arrangement

#+begin_src conf :noweb yes
"modules-left": [
  "hyprland/workspaces",
  "mpris",
  "custom/mpv-repeat"
  // "custom/vpn"
],

"modules-center": ["clock", "privacy"],

"modules-right": [
"custom/email",
  "tray",
  // "cpu_text",
  "cpu",
  "memory",
  "network",
  <<laptop_modules()>>
  "pulseaudio"
],
#+end_src

*** Laptop-specific
#+name: laptop_modules
#+begin_src bash :noweb yes :results raw :tangle no
[ <<chassis()>> == "laptop" ] && cat << 'EOF'|head -c -1
  "bluetooth",
  "battery",
EOF
#+end_src

#+RESULTS: laptop_modules

*** Custom
#+begin_src conf
"custom/vpn": {
  "format": "VPN ÔÄ£",
  "exec": "echo '{\"class\": \"connected\"}'",
  "exec-if": "test -d /proc/sys/net/ipv4/conf/tun0",
  "return-type": "json",
  "interval": 5
},
"custom/email": {
  "format": "üì¨",
  "on-click": "pizauth show personal 2>&1|awk '{print $NF}'|xargs floorp"
},
#+end_src

*** Built-in
 #+begin_src conf :epilogue "}"
  "privacy": {
    "icon-spacing": 4,
    "icon-size": 18,
    "transition-duration": 250,
    "modules": [
      {
	"type": "screenshare",
	"tooltip": true,
	"tooltip-icon-size": 24
      },
      {
	"type": "audio-in",
	"tooltip": true,
	"tooltip-icon-size": 24
      }
    ],
    "ignore-monitor": true,
    "ignore": [
      {
	"type": "audio-in",
	"name": "cava"
      },
      {
	"type": "screenshare",
	"name": "obs"
      }
    ]
  },
  "tray": {
    "spacing": 10,
    "tooltip": false
  },

  "clock": {
    "format": "{:%I:%M %p - %a, %d %b %Y}",
    "tooltip": false
  },

  "cpu": {
    "format": "cpu {usage}%",
    "interval": 2,

    "states": {
      "critical": 90
    }
  },

  "memory": {
    "format": "mem {percentage}%",
    "interval": 2,

    "states": {
      "critical": 80
    }
  },

  "battery": {
    "format": "bat {capacity}%",
    "interval": 5,
    // "states": {
    //     "warning": 20,
    //     "critical": 10
    // },
    "tooltip": false,

    "states": {
      // "good": 95,
      "warning": 30,
      "critical": 15
    },
    //"format": "{capacity}% {icon}",
    "format-full": "{capacity}% {icon}",
    "format-charging": "{capacity}% Ôóß",
    "format-plugged": "{capacity}% Ôá¶",
    "format-alt": "{time} {icon}",
    // "format-good": "", // An empty format will hide the module
    // "format-full": "",
    "format-icons": ["ÔâÑ", "ÔâÉ", "ÔâÇ", "ÔâÅ", "ÔâÄ"]
  },

// stato della connessione
  "network": {
    "format-wifi": "wifi {bandwidthDownBits}",
    "format-ethernet": "enth {bandwidthDownBits}",
    "format-disconnected": "no network",
    "interval": 5,
    "tooltip": false
  },

  "hyprland/workspaces": {
    "disable-scroll": true,
    "all-outputs": true,
    "warp-on-scroll": false,
    "format": "{name}: {icon}",
    "format-icons": {
      "1": "ÔÑ†",
      "2": "Ôâ®",
      "3": "ÔÑ°",
      "4": "ÔÜº",
      "5": "ÔÅµ",
      "urgent": "ÔÅ™",
      // would be cool it just coloured the corresponding icon... or the background or line at the top...
      //"focused": "ÔÜí",
      "active": "ÔÜí",
      "default": "ÔÑë"
    }
  },

"custom/mpv-repeat": {
    "exec": "echo '{ \"command\": [\"get_property\", \"loop-file\"] }' | socat - /tmp/mpvsocket | jq -r 'if .data == \"inf\" then \"{\\\"text\\\":\\\"üîÅ\\\"}\" else \"{\\\"text\\\":\\\"\\\"}\" end'",
   "exec-if": "pgrep mpv",
    "interval": 2,
    "return-type": "json"
},
  "mpris": {
  // loop-status?üîÅ
    // "format": "{player_icon}  {title} - {artist} [{position} / {length}]",
    "format": "üéµ  {title} - {artist} [{position} / {length}] ",
    "format-paused": "{player_icon}  {title} - {artist} [{position} / {length}]",

    "player-icons": {
      "default": "Û∞ùö ",
      "spotify": "<span foreground='#a6e3a1'>Û∞ìá </span>",
      "firefox": "<span foreground='#f38ba8'>Û∞óÉ </span>",
      "mpv": "ÔÄÅ"
    },
    "status-icons": {
      "paused": "<span color='#b4befe'>\u200A\u200AÛ∞è§\u2009\u2009</span>"
    },

    "tooltip-format": "Playing: {title} - {artist}",
    "tooltip-format-paused": "Paused: {title} - {artist}",
        // how to fit at most to next section?
    "max-length": 70,

    // "ignored-players": ["firefox"],
    "interval": 1,

    "on-scroll-up": "playerctl position 3+",
    "on-scroll-down": "playerctl position 3-"
  },
  // https://man.archlinux.org/man/extra/waybar/waybar-bluetooth.5.en
  "bluetooth": {
    // "controller": "controller1", // specify the alias of the controller if there are more than 1 on the system
    "format": "Ôäî {status}",
    // hide no-controller?
    "format-disabled": "", // an empty format will hide the module
    "format-connected": "Ôäî {num_connections} connected",
    "tooltip-format": "{controller_alias}\t{controller_address}",
    "tooltip-format-connected": "{controller_alias}\t{controller_address}\n\n{device_enumerate}",
    "tooltip-format-enumerate-connected": "{device_alias}\t{device_address}"
  },
"pulseaudio": {
	"format": "{volume}% {icon}",
	"format-bluetooth": "{volume}% {icon}Ôäî",
	"format-muted": "ÔÄ¶",
	"format-icons": {
		"alsa_output.pci-0000_00_1f.3.analog-stereo": "Óå≠",
		"alsa_output.pci-0000_00_1f.3.analog-stereo-muted": "Óª®Óå≠",
		"headphones": "ÔÄ•",
		"handsfree": "Ôñê",
		"headset": "Ôñê",
		"phone": "ÔÇï",
		"phone-muted": "Ó¥ó",
		"portable": "ÔÇï",
		"car": "ÔÜπ",
		"default": ["ÔÄß", "ÔÄ®"]
	},
	"scroll-step": 1,
	"on-click": "pavucontrol"
},
#+end_src

* Style
:PROPERTIES:
:header-args: :tangle ~/.config/waybar/style.css
:END:


Group related info in boxes
Can you reference which modules are on the left/center/right here/

#+begin_src css
,* {
    border: none;
    border-radius: 8px;
    min-height: 0;
    font-family: "Fira Code";
    font-weight: 500;
    font-size: 14px;
    padding: 0;
}

window#waybar {
    background: rgba(75, 42, 94, 0.85);
    border: none;
    border-bottom: 3px solid transparent;
    background-image: linear-gradient(rgba(75, 42, 94, 0.85), rgba(75, 42, 94, 0.85)),
                      linear-gradient(90deg, #d35dae 0%, #8b5aa8 50%, #5a3a7e 100%);
    background-origin: border-box;
    background-clip: padding-box, border-box;
}

tooltip {
    background-color: #4b2a5e;
    border: 2px solid #8b5aa8;
    border-radius: 8px;
    padding: 8px;
}

#bluetooth,
#clock,
#tray,
#cpu,
#memory,
#battery,
#network,
#pulseaudio,
#custom-email {
    margin: 6px 6px 6px 0px;
    padding: 2px 8px;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.6);
}

#custom-email {
    margin-left: 12px;
}

#workspaces {
    background: linear-gradient(135deg, #6a4a9e 0%, #5a3a7e 50%, #4a2a6e 100%);
    margin: 6px 12px 6px 6px;
    border: 2px solid rgba(122, 74, 158, 0.6);
    box-shadow: 0 4px 16px rgba(106, 74, 158, 0.5), inset 0 1px rgba(255, 255, 255, 0.1);
    padding: 2px;
}

#workspaces button {
    all: initial;
    min-width: 0;
    padding: 4px 8px;
    margin: 2px 3px;
    border-radius: 6px;
    color: #e1c3f0;
    background: rgba(240, 209, 255, 0.05);
}

#workspaces button.focused {
    color: #ffffff;
    background: linear-gradient(135deg, #e06dbe 0%, #d35dae 100%);
    box-shadow: 0 2px 8px rgba(211, 93, 174, 0.6), inset 0 1px rgba(255, 255, 255, 0.2);
}

#workspaces button.active {
    color: #f0d1ff;
    background: rgba(211, 93, 174, 0.3);
    box-shadow: inset 0 0 8px rgba(211, 93, 174, 0.4);
}

#workspaces button.urgent {
    background-color: #d35dae;
}

#workspaces button:hover {
    background: rgba(211, 93, 174, 0.2);
    color: #f5e1ff;
}

#clock {
    background: linear-gradient(135deg, #6a4a9e 0%, #5a3a7e 100%);
    border: 2px solid rgba(122, 74, 158, 0.6);
    color: #ffffff;
    font-weight: 700;
    margin: 6px 0px 6px 12px;
    padding: 2px 8px;
    box-shadow: 0 3px 10px rgba(106, 74, 158, 0.4), inset 0 1px rgba(255, 255, 255, 0.1);
    letter-spacing: 0.5px;
}

#privacy {
    background: linear-gradient(135deg, #5a3a7e 0%, #4a2a6e 100%);
    border: 2px solid #7a4a9e;
    color: #f0d1ff;
    margin: 6px 12px 6px 0px;
    padding: 2px 8px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}

#mpris,
#custom-mpv-repeat {
    background: linear-gradient(135deg, #5a3a7e 0%, #4a2a6e 100%);
    border: 2px solid #7a4a9e;
    color: #f0d1ff;
    margin: 6px 6px 6px 0px;
    padding: 2px 8px;
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.6);
}

#network {
    border-left: 3px solid #8b5aa8;
}

#mpris {
    margin-left: 6px;
}

#cpu {
    border-left: 3px solid #d35dae;
}

#memory {
    border-left: 3px solid #c84aae;
}

#custom-mpv-repeat {
    margin-left: 0px;
}

#tray {
    background: linear-gradient(135deg, #f5e1ff 0%, #f0d1ff 100%);
    border: 2px solid #e1c3f0;
}

#battery {
    border: 2px solid rgba(232, 127, 184, 0.8);
    color: #4b2a5e;
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(211, 93, 174, 0.5), inset 0 1px rgba(255, 255, 255, 0.2);
}

#bluetooth,
#cpu,
#memory,
#network,
#pulseaudio {
    background: linear-gradient(135deg, #ffffff 0%, #f5e1ff 50%, #f0d1ff 100%);
    border: 2px solid rgba(225, 195, 240, 0.8);
    color: #4b2a5e;
    box-shadow: 0 2px 8px rgba(240, 209, 255, 0.3), inset 0 1px rgba(255, 255, 255, 0.5);
}

#tray:hover,
#pulseaudio:hover,
#custom-email:hover {
    background-color: #e1c3f0;
}

#custom-email {
  background-color: #ffbbbb;
  border: 2px solid #ffaaaa;
  box-shadow: 0 4px 10px rgba(255, 170, 170, 0.4);
}

#cpu.critical,
#memory.critical {
    background-color: #f0d1ff;
    border: 2px solid #e1c3f0;
    color: #d35dae;
    font-weight: 700;
}

#battery.warning,
#battery.critical,
#battery.urgent {
    background-color: #f0d1ff;
    border: 2px solid #e1c3f0;
    color: #d35dae;
    font-weight: 700;
}
#+end_src
